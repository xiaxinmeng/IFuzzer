with closing(gen()) as argument:
    for x in map(fn, argument): ...